{% extends "base.html" %}
{% block content %}
{% set lang = lang %}

<h1>{{ "Корзина" if lang=="ru" else "Grozs" }}</h1>

{% for item in cart_items %}
<div class="cart-item">
  <img src="{{ item.product.image }}" class="cart-item-image">
  <b>{{ item.product["name_"+lang] }}</b>
  {{ item.qty }} шт
  <div class="qty-controls">
    <button onclick="changeQty({{ item.product.id }},'minus')">−</button>
    <button onclick="changeQty({{ item.product.id }},'plus')">+</button>
  </div>
</div>
{% endfor %}

<p><b>Итого:</b> {{ total }} €</p>

<a href="/" class="buy-btn">На главную</a>
<a href="/catalog" class="buy-btn">В каталог</a>

<script>
function changeQty(id,a){
 fetch(`/api/update_cart/${id}/${a}`,{method:'POST'})
 .then(()=>location.reload());
}
</script>
{% endblock %}
