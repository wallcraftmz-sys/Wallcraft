{% extends "admin/admin_base.html" %}
{% block content %}

<h1>üßæ –ó–∞–∫–∞–∑—ã</h1>

<div style="margin-bottom:20px; display:flex; gap:10px;">
    <a href="{{ url_for('admin_orders', show='active') }}"
       class="admin-link {% if show == 'active' %}primary{% endif %}">
        –ê–∫—Ç–∏–≤–Ω—ã–µ
    </a>

    <a href="{{ url_for('admin_orders', show='archive') }}"
       class="admin-link {% if show == 'archive' %}primary{% endif %}">
        –ê—Ä—Ö–∏–≤
    </a>
</div>

{% if orders %}
<table class="admin-table">
    <thead>
        <tr>
            <th>ID</th>
            <th>–ü–æ–∫—É–ø–∞—Ç–µ–ª—å</th>
            <th>–°–æ—Å—Ç–∞–≤</th>
            <th>–°—É–º–º–∞</th>
            <th>–°—Ç–∞—Ç—É—Å</th>
            <th>–î–∞—Ç–∞</th>
            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
    </thead>
    <tbody>
        {% for order in orders %}
        <tr class="status-row status-{{ order.status }}">
            <td>
    <a href="{{ url_for('admin_order_view', order_id=order.id) }}">
        #{{ order.id }}
    </a>
</td>

            <td>
                {{ order.name }}<br>
                <small>{{ order.contact }}</small>
            </td>

            <td style="white-space: pre-line">{{ order.items }}</td>

            <td><strong>{{ order.total }} ‚Ç¨</strong></td>

            <!-- –°–¢–ê–¢–£–° -->
            <td>
                <form method="post"
                      action="{{ url_for('update_order_status', order_id=order.id) }}">
                    <select name="status" onchange="this.form.submit()">
                        {% for key, labels in ORDER_STATUSES.items() %}
                        <option value="{{ key }}"
                                {% if order.status == key %}selected{% endif %}>
                            {{ labels[lang] }}
                        </option>
                        {% endfor %}
                    </select>
                </form>
            </td>

            <td>{{ order.created_at.strftime("%d.%m.%Y %H:%M") }}</td>

            <!-- üóë –£–î–ê–õ–ò–¢–¨ -->
            <td>
                <form method="post"
                      action="{{ url_for('delete_order', order_id=order.id) }}"
                      onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å –∑–∞–∫–∞–∑ –Ω–∞–≤—Å–µ–≥–¥–∞?');">
                    <button type="submit" class="danger-btn">üóë</button>
                </form>
            </td>

        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>–ù–µ—Ç –∑–∞–∫–∞–∑–æ–≤</p>
{% endif %}

{% endblock %}
