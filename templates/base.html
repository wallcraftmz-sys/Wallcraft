<!DOCTYPE html>
<html lang="{{ lang }}">
<head>
  <meta charset="UTF-8">
  <title>Wallcraft</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=9999">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/theme.css') }}">

  <script defer src="{{ url_for('static', filename='js/main.js') }}"></script>
</head>

<body class="{% if request.path.startswith('/admin') %}is-admin{% endif %}">

{% set T = {
  "home": {"ru": "–ì–ª–∞–≤–Ω–∞—è", "lv": "SƒÅkums", "en": "Home"},
  "catalog": {"ru": "–ö–∞—Ç–∞–ª–æ–≥", "lv": "Katalogs", "en": "Catalog"},
  "about": {"ru": "–û –∫–æ–º–ø–∞–Ω–∏–∏", "lv": "Par mums", "en": "About"},
  "profile": {"ru": "–ü—Ä–æ—Ñ–∏–ª—å", "lv": "Profils", "en": "Profile"},
  "admin": {"ru": "–ê–¥–º–∏–Ω–∫–∞", "lv": "Admin", "en": "Admin"},
  "login": {"ru": "–í—Ö–æ–¥", "lv": "IenƒÅkt", "en": "Login"},
  "register": {"ru": "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è", "lv": "Reƒ£istrƒÅcija", "en": "Register"},
  "logout": {"ru": "–í—ã–π—Ç–∏", "lv": "Iziet", "en": "Logout"},
  "added": {"ru": "–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É", "lv": "Prece pievienota grozam", "en": "Product added to cart"},
  "continue": {"ru": "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏", "lv": "TurpinƒÅt iepirkties", "en": "Continue shopping"},
  "cart": {"ru": "–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É", "lv": "Doties uz grozu", "en": "Go to cart"}
} %}

<header class="top-header">
  <button class="menu-btn" type="button" onclick="toggleMenu()" aria-label="Menu">‚ò∞</button>

  <div class="logo-center">
    <a href="/" class="logo-link">
      <img src="{{ url_for('static', filename='images/IMG_0857.jpeg') }}"
           alt="Wallcraft logo"
           class="logo-img">
      <span class="logo-text">Wallcraft</span>
    </a>
  </div>

  <div class="lang-switch">
    <a href="{{ request.path }}?lang=ru" class="{{ 'active' if lang == 'ru' }}">RU</a> |
    <a href="{{ request.path }}?lang=lv" class="{{ 'active' if lang == 'lv' }}">LV</a> |
    <a href="{{ request.path }}?lang=en" class="{{ 'active' if lang == 'en' }}">EN</a>
  </div>
</header>

<!-- OVERLAY -->
<div id="menuOverlay" class="menu-overlay" onclick="closeMenu()"></div>

<!-- SIDE MENU -->
<div id="sideMenu" class="side-menu">
  <a href="/" onclick="closeMenu()">üè† {{ T.home[lang] }}</a>
  <a href="/catalog" onclick="closeMenu()">üì¶ {{ T.catalog[lang] }}</a>
  <a href="/about" onclick="closeMenu()">‚ÑπÔ∏è {{ T.about[lang] }}</a>

  <hr>

  {% if current_user.is_authenticated %}
    {% if current_user.role == "admin" %}
      <a href="{{ url_for('admin_panel') }}">{{ T.admin[lang] }}</a>
    {% else %}
      <a href="/profile">{{ T.profile[lang] }}</a>
    {% endif %}
    <a href="/logout">{{ T.logout[lang] }}</a>
  {% else %}
    <a href="/login">{{ T.login[lang] }}</a>
    <a href="/register">{{ T.register[lang] }}</a>
  {% endif %}
</div>

<!-- MAIN CONTENT -->
<main class="container">
  {% block content %}{% endblock %}
</main>

{# ‚úÖ –í–°–Å, —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –∫–æ—Ä–∑–∏–Ω–æ–π/–ø–æ–ø–∞–ø–æ–º ‚Äî –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤ –∞–¥–º–∏–Ω–∫–µ #}
{% if not request.path.startswith('/admin') %}

  <!-- CART POPUP (–ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ JS) -->
  <div id="cart-popup" class="cart-popup" aria-hidden="true">
    <div class="cart-popup-content">
      <p>‚úÖ {{ T.added[lang] }}</p>

      <a href="/catalog" class="popup-btn" onclick="closeCartPopup()">{{ T.continue[lang] }}</a>
      <a href="/cart" class="popup-btn primary">{{ T.cart[lang] }}</a>

      <button class="close-popup" type="button" onclick="closeCartPopup()">√ó</button>
    </div>
  </div>

  <!-- FLOATING CART -->
  <a href="{{ url_for('cart') }}" class="cart-btn" aria-label="–ö–æ—Ä–∑–∏–Ω–∞">
    üõí <span id="cart-count">0</span>
  </a>

{% endif %}

<script>
  // —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞: –µ—Å–ª–∏ –º–µ–Ω—é "–∑–∞–ª–∏–ø–ª–æ"
  document.addEventListener("DOMContentLoaded", () => {
    try { closeMenu(); } catch(e) {}
    document.body.style.overflow = "";
  });
</script>

</body>
</html>
